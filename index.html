<!DOCTYPE html>
<html lang="fa">
<head>
    <meta charset="UTF-8">
    <title>نمایش حجم فایل گوگل درایو</title>
    <style>
        body {
            font-family: Tahoma, Arial, sans-serif;
            background: #f0f4fa;
            direction: rtl;
            text-align: center;
        }
        .main {
            margin: 50px auto;
            background: #fff;
            padding: 36px;
            border-radius: 16px;
            max-width: 400px;
            box-shadow: 0 2px 8px #aaa5;
        }
        input[type="text"] {
            width: 90%;
            padding: 9px 6px;
            border-radius: 8px;
            border: 1px solid #bbb;
            margin-bottom: 20px;
            font-size: 15px;
        }
        button {
            background: #1a73e8;
            color: #fff;
            border: none;
            padding: 9px 26px;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
        }
        .result {
            margin-top: 23px;
            font-size: 16px;
        }
    </style>
</head>
<body>
    <div class="main">
        <h2>دریافت حجم فایل گوگل درایو</h2>
        <input type="text" id="driveUrl" placeholder="لینک مستقیم فایل گوگل درایو را وارد کنید">
        <br>
        <button onclick="getFileSize()">بررسی حجم فایل</button>
        <div class="result" id="result"></div>
    </div>
    <script>
        async function getFileSize() {
            const url = document.getElementById('driveUrl').value.trim();
            const resultEl = document.getElementById('result');
            // استخراج شناسه فایل (fileId)
            let match = url.match(/\/d\/([a-zA-Z0-9_-]+)/) ||
                        url.match(/id=([a-zA-Z0-9_-]+)/);
            if (!match) {
                resultEl.innerText = 'لینک نامعتبر است.';
                return;
            }
            const fileId = match[1];
            // کلید API خود را جایگزین کنید
            const apiKey = 'YOUR_GOOGLE_DRIVE_API_KEY';
            const apiUrl = `https://www.googleapis.com/drive/v3/files/${fileId}?fields=size&key=${apiKey}`;
            resultEl.innerText = 'در حال دریافت اطلاعات...';
            try {
                const res = await fetch(apiUrl);
                if (!res.ok) throw new Error('خطا در دریافت اطلاعات');
                const data = await res.json();
                if (!data.size)
                    resultEl.innerText = 'فایل موردنظر حجم ندارد (مثلاً فایل Google Docs).';
                else {
                    const size = Number(data.size);
                    let sizeMb = (size / (1024 * 1024)).toFixed(2);
                    resultEl.innerHTML = `حجم فایل: <b>${sizeMb} مگابایت</b> (${size} بایت)`;
                }
            } catch (e) {
                resultEl.innerText = 'خطا در دریافت اطلاعات یا دسترسی به فایل (ممکن است فایل خصوصی باشد یا کلید API مشکل داشته باشد).';
            }
        }
    </script>
</body>
</html>
